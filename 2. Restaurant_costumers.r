install.packages('nnet')
install.packages('NeuralNetTools')

# ?????????????????? ?????????????????????? ????????????????????
library(NeuralNetTools)
library(nnet)

# ?????????? ???????????????????? ???? R ?? RStudio  ?????????????????? ?????????????????????????????????? ???????????? RWeka
# ?? ?????????????? ?????? (???? ????????????????????) ?????????? ?????????????????????? ???? ???? java 
library(RWeka) # ?????? ???????????? ????????????

# ?????????????????????????? ?????????????? ???????????????????? ?????? ????????????????????
setwd('~/r/NeuralNetR')
getwd()

# ?????????????????? ???????????? ???? ?????????????? ??????????????????????

mydata = read.csv('RestaurantTips.csv', sep = ';', header = T)
mydata

# ???????????????????? ?? ?????????? ?????????????? ????????????????
attach(mydata)
names(mydata)

# ?????????????? ???????????? ?????????????????? ????????

model = nnet(CustomerWillTip ~ Service + Ambience + Food,
             data = mydata,
             size = c(3, 5),
             rang = 0.1,
             decay = 5e-2,
             maxit = 5000 )

# ?? ???????????? ???????????????? ???? ???????????????????? ?????????? ????????????!

print(model)
plotnet(model)
garson(model)

# ?? ?????????????? ???????????? NeuralNetTools ???? ???????? ?????????????????? 
# ?????????? ?????? ?????????????????? ???????? ?? ?????????????????????? ?????????????? ???????????????? 
# ???? ?????????????????? ?????????????????? ???????? 

model1 = nnet(CustomerWillTip ~ Service + Ambience + Food,
              data = mydata,
              size = 1,
              rang = 0.1,
              decay = 5e-2,
              maxit = 5000 )
plotnet(model1)

# ??????????????

Service <- c(9, 5, 4)
Ambience <- c(7, 6, 8)
Food <- c(4, 6, 7)
test <- data.frame(Service, Ambience, Food)

predict(model1, newdata = test)